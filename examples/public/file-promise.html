<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Promise Example - Watson Speech to Text</title>
</head>
<body>

    <section>
        <h1>Transcribe File</h1>
        <input type="file" id="audiofile"> <button id="button">Transcribe</button>
        <p><small><i>Supported types are wav, ogg/opus (not ogg/vorbis), and flac.</i></small></p>

        <h2>Output:</h2>
        <div id="output">--</div>
    </section>

    <script src="watson-speech-to-text.js"></script>
    <script src="http://code.jquery.com/jquery-2.2.0.min.js"></script>

    <h2>Code for this demo:</h2>
    <pre><code><script style="display: block;">
$(function() {
    $.get('/token').then(function (token) {

        // each token may be reused for up to an hour
        // the connection will close with code 1006 when the token is expired or otherwise invalid
        var stt =  new WatsonSpeechToText({
            token: token
        });

        var $output = $('#output');

        $('#button').click(function () {
            $output.html('Processing...');

            stt.promise({
                file: $('#audiofile')[0]
            })
            .then(function(results) {
                console.log('results', results);
                return results;
            })
            .then(WatsonSpeechToText.resultsToText) // turn the collection of results into a string of text
            .then(function(text) {
                console.log('text', text);
                return text;
            })
            .then(function(text) {
                running = false;
                $output.text(text);
            }).catch(function(err) {
                running = false;
                console.log(err);
                $output.text(err.message);
            });
        });
    });
});
    </script></code></pre>
</body>
</html>
