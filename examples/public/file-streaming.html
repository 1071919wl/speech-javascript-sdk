<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>File Promise Example - Watson Speech to Text</title>
</head>
<body>

<section>
    <h2>Transcribe File, Streaming</h2>
    <input type="file" id="audiofile"> <button id="start-stop">Transcribe</button>
    <p>Supported types are wav, ogg/opus (not ogg/vorbis), and flac.</p>

    <p>Output:</p>
    <div id="file"></div>
</section>

<script src="watson-speech-to-text.js"></script>
<script src="http://code.jquery.com/jquery-2.2.0.min.js"></script>

<h2>Code for this demo:</h2>
<code><pre><script style="display: block;">
    $(function() {
        $.get('/token').then(function (token) {

            // each token may be reused for up to an hour
            // the connection will close with code 1006 when the token
            var stt =  new WatsonSpeechToText({
                token: token
            });

            var $output = $('#output');

            $('#start-stop').click(function () {
                $output.html('Processing...');

                stt.promise({
                    file: $('#audiofile')[0].files[0],
                    playFile: false
                })
                        .then(function(results) {
                            console.log(results);
                            return results;
                        })
                        .then(WatsonSpeechToText.resultsToText) // turn the collection of results into a string of text
                        .then(function(text) {
                            running = false;
                            $output.text(text);
                        }).catch(function(err) {
                            running = false;
                            console.log(err);
                            $output.text(err.message);
                        });
            });
        });
    });
</script></pre></code>
</body>
</html>
